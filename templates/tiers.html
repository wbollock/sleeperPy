<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SleeperPy Tiers</title>
    <link rel="stylesheet" href="/static/main.css">
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
</head>
<body>
<header class="app-header">
    <h1><a href="/" style="color:inherit; text-decoration:none;">SleeperPy Fantasy Tiers</a></h1>
</header>
<div class="main-content">
        <div class="legend" style="margin-bottom:18px; font-size:0.95em; color:#b6c6e0; display:flex; flex-wrap:wrap; gap:15px; align-items:center;">
            <span style="font-weight:bold; margin-right:5px;">Legend:</span>
            <span><span class="tier1-star">★</span> Tier 1</span>
            <span><span style="background:#7bb0ff;color:#1a1f2e;padding:2px 5px;border-radius:3px;font-size:0.85em;font-weight:bold;">FLEX</span> FLEX tier</span>
            <span><span class="swap-icon">⇄</span> Swap</span>
            <span style="background:#3a1e1e; color:#ffb6b6; padding:2px 6px; border-radius:4px;">Red = Suboptimal</span>
        </div>
{{if .Error}}
<span style="color:red">{{.Error}}</span>
{{else}}
{{with .Leagues}}
    {{/* Shareable link box removed as the URL is self-evident */}}
{{end}}

<script>
function showLeagueTab(evt, tabId) {
    document.querySelectorAll('.league-content').forEach(div => div.style.display = 'none');
    document.getElementById(tabId).style.display = 'block';
    document.querySelectorAll('.league-tab').forEach(btn => btn.classList.remove('active'));
    evt.currentTarget.classList.add('active');
}
</script>

<div class="league-tabs">
    {{range $i, $l := .Leagues}}
        <button class="league-tab" {{if eq $i 0}}id="defaultTab"{{end}} onclick="showLeagueTab(event, 'league{{$i}}')">{{$l.LeagueName}} ({{$l.Scoring}})</button>
    {{end}}
</div>
<div class="league-contents">
    {{range $i, $l := .Leagues}}
        <div class="league-content" id="league{{$i}}" style="display:{{if eq $i 0}}block{{else}}none{{end}};">
            <table class="sortable-table pretty-table">
                <thead>
                    <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                </thead>
                <tbody>
                {{range $l.Starters}}
                    <tr{{if eq .Tier 1}} class="tier1"{{else if .IsTierWorseThanBench}} class="tier-worse"{{end}}>
                        <td>{{.Pos}}</td>
                        <td>{{if eq .Tier 1}}<span class="tier1-star">★</span> {{end}}{{.Name | safe}}</td>
                        <td>{{.Tier}}{{if .IsFlex}} <span style="background:#7bb0ff;color:#1a1f2e;padding:2px 5px;border-radius:3px;font-size:0.85em;font-weight:bold;">FLEX</span>{{else if .IsSuperflex}} <span style="background:#7bb0ff;color:#1a1f2e;padding:2px 5px;border-radius:3px;font-size:0.85em;font-weight:bold;">SF</span>{{end}}</td>
                    </tr>
                {{end}}
                {{range $l.Unranked}}
                    <tr>
                        <td>
                            {{if eq .Pos "FLEX"}}<span style="color:#7bb0ff;font-weight:bold;">FLEX</span>{{else if eq .Pos "SUPERFLEX"}}<span style="color:#7bb0ff;font-weight:bold;">SUPERFLEX</span>{{else}}{{.Pos}}{{end}}
                        </td>
                        <td>{{.Name | safe}}</td>
                        <td>{{.Tier}}</td>
                    </tr>
                {{end}}
                </tbody>
                <tfoot>
                    <tr><td colspan="3" class="summary"><b>Average Tier: {{$l.AvgTier}}</b></td></tr>
                    <tr><td colspan="3" class="summary"><b>Opponent Average Tier: {{$l.AvgOppTier}}</b></td></tr>
                    <tr>
                        <td colspan="3" class="summary">
                            <div class="winprob-row">
                                <span class="winprob-label">Win Probability:</span>
                                <span class="winprob-bar-wrap">
                                    <span class="winprob-bar-bg">
                                        <span class="winprob-bar" style="width: {{parseWinProb $l.WinProb}}%; background: {{winProbColor $l.WinProb}};"></span>
                                    </span>
                                </span>
                                <span class="winprob-badge" style="background: {{winProbColor $l.WinProb}};">
                                    {{parseWinProb $l.WinProb}}%
                                </span>
                                <span class="winprob-emoji">{{parseWinEmoji $l.WinProb}}</span>
                            </div>
                        </td>
                    </tr>
                    <tr><th colspan="3" class="bench-header">Bench</th></tr>
                    {{range $l.Bench}}
                        <tr{{if eq .Tier 1}} class="tier1"{{else if .ShouldSwapIn}} class="swap-candidate"{{end}}><td>{{.Pos}}</td><td>{{if eq .Tier 1}}<span class="tier1-star">★</span> {{end}}{{if .ShouldSwapIn}}<span class="swap-icon">⇄</span> {{end}}{{.Name | safe}}</td><td>{{.Tier}}{{if and .IsFlex .ShouldSwapIn}} <span style="background:#7bb0ff;color:#1a1f2e;padding:2px 5px;border-radius:3px;font-size:0.85em;font-weight:bold;">FLEX</span>{{end}}</td></tr>
                    {{end}}
                    {{range $l.BenchUnranked}}
                        <tr><td>{{.Pos}}</td><td>{{.Name | safe}}</td><td>{{.Tier}}</td></tr>
                    {{end}}
                    <tr><td colspan="3" style="padding-top:8px;font-size:0.9em;color:#9fb3d4;font-style:italic;">Note: RB/WR/TE bench players ranked using FLEX tiers</td></tr>
                </tfoot>
            </table>

            {{if $l.TopFreeAgents}}
            <div class="fa-section">
                <div class="fa-header">Recommended Free Agents</div>
                <table class="sortable-table pretty-table">
                    <thead>
                        <tr><th>Pos</th><th>Player</th><th>Tier</th></tr>
                    </thead>
                    <tbody>
                    {{range $l.TopFreeAgents}}
                        <tr{{if .IsUpgrade}} class="fa-upgrade"{{end}}>
                            <td>{{.Pos}}</td>
                            <td>
                                {{if .IsUpgrade}}<span class="fa-upgrade-icon">⬆</span> {{end}}{{.Name | safe}}
                                {{if .IsUpgrade}}
                                    <div style="font-size:0.85em;color:#3ae87a;margin-top:2px;">Upgrade for {{.UpgradeType}}: {{.UpgradeFor}}</div>
                                {{end}}
                            </td>
                            <td>{{.Tier}}</td>
                        </tr>
                    {{end}}
                    </tbody>
                </table>
            </div>
            {{end}}

            <br>
        </div>
    {{end}}
</div>
</div>
<script>
if (document.getElementById('defaultTab')) document.getElementById('defaultTab').click();
</script>
<script src="/static/sortable.js"></script>

<footer style="margin-top:2em; text-align:center; font-size:1em; color:#888;">
        <div style="margin-bottom:0.5em;">
            Tiers powered by <a href="https://www.borischen.co/" target="_blank" rel="noopener">Boris Chen</a> |
            <a href="https://github.com/wbollock/sleeperPy" target="_blank" rel="noopener">GitHub Repo</a>
            <span style="margin-left:1em; color:#666;">If you like this project, please <a href="https://github.com/wbollock/sleeperPy" target="_blank" rel="noopener">drop a ⭐ on GitHub</a>!</span>
        </div>
</footer>
{{end}}
<style>
    .app-header {
        width: 100%;
        background: linear-gradient(90deg, #232c41 0%, #3a6ee8 100%);
        padding: 32px 0 18px 0;
        text-align: center;
        margin-bottom: 18px;
        box-shadow: 0 2px 12px rgba(30,38,54,0.10);
    }
    .app-header h1 {
        color: #eaf0fa;
        font-family: 'Raleway', Arial, sans-serif;
        font-size: 2.3em;
        font-weight: 800;
        letter-spacing: 1px;
        margin: 0;
        text-shadow: 0 2px 8px rgba(30,38,54,0.18);
    }
    .main-content {
        max-width: 900px;
        margin: 0 auto;
        padding: 24px 16px 0 16px;
        background: rgba(35,44,65,0.98);
        border-radius: 10px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.12);
    }
.fa-section { margin-top: 1.5em; margin-bottom: 1em; }
.fa-header { font-size: 1.15em; font-weight: bold; margin-bottom: 0.8em; color: #7bb0ff; }
.fa-upgrade { background: #1e3a2e !important; }
.fa-upgrade-icon { color: #3ae87a; font-weight: bold; font-size: 1.2em; margin-right: 4px; }
</style>
</body>
</html>
