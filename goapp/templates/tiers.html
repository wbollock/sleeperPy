<html>
<head>
    <meta charset="UTF-8">
    <title>SleeperPy Tiers</title>
    <link rel="stylesheet" href="/static/main.css">
</head>
<body>
<header class="app-header">
    <h1><a href="/" style="color:inherit; text-decoration:none;">SleeperPy Fantasy Tiers</a></h1>
</header>
<div class="main-content">
        <div class="legend" style="margin-bottom:18px; font-size:1.08em; color:#b6c6e0;">
            <b>Legend:</b>
            <span style="margin-left:10px;"><span class="tier1-star">★</span> = Tier 1</span>
            <span style="margin-left:10px;"><span class="swap-icon">⇄</span> = Swap candidate</span>
            <span style="margin-left:10px;"><span style="color:#2e7d32;">⬆️</span> = Free agent upgrade</span>
            <span style="margin-left:10px;"><span style="background:#3a1e1e; color:#ffb6b6; padding:2px 6px; border-radius:4px;">red row</span> = Suboptimal starter</span>
        </div>
{{if .Error}}
<span style="color:red">{{.Error}}</span>
{{else}}
{{with .Leagues}}
    {{/* Shareable link box removed as the URL is self-evident */}}
{{end}}
<div class="league-tabs">
    {{range $i, $l := .Leagues}}
        <button class="league-tab" onclick="showLeagueTab(event, 'league{{$i}}')" {{if eq $i 0}}id="defaultTab"{{end}}>{{$l.LeagueName}} ({{$l.Scoring}})</button>
    {{end}}
</div>
<div class="league-contents">
    {{range $i, $l := .Leagues}}
        <div class="league-content" id="league{{$i}}" style="display:{{if eq $i 0}}block{{else}}none{{end}};">
            <table class="sortable-table pretty-table">
                <thead>
                    <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                </thead>
                <tbody>
                {{range $l.Starters}}
                    <tr{{if eq .Tier 1}} class="tier1"{{else if .IsTierWorseThanBench}} class="tier-worse"{{end}}>
                        <td>
                            {{if eq .Pos "FLEX"}}<span style="color:#7bb0ff;font-weight:bold;">FLEX</span>{{else if eq .Pos "SUPERFLEX"}}<span style="color:#7bb0ff;font-weight:bold;">SUPERFLEX</span>{{else}}{{.Pos}}{{end}}
                        </td>
                        <td>{{if eq .Tier 1}}<span class="tier1-star">★</span> {{end}}{{.Name | safe}}
                            {{if .IsSuperflex}}<span style="color:#7bb0ff;font-weight:bold; margin-left:6px;">[SUPERFLEX]</span>{{else if .IsFlex}}<span style="color:#7bb0ff;font-weight:bold; margin-left:6px;">[FLEX]</span>{{end}}
                        </td>
                        <td>{{.Tier}}</td>
                    </tr>
                {{end}}
                {{range $l.Unranked}}
                    <tr>
                        <td>
                            {{if eq .Pos "FLEX"}}<span style="color:#7bb0ff;font-weight:bold;">FLEX</span>{{else if eq .Pos "SUPERFLEX"}}<span style="color:#7bb0ff;font-weight:bold;">SUPERFLEX</span>{{else}}{{.Pos}}{{end}}
                        </td>
                        <td>{{.Name | safe}}</td>
                        <td>{{.Tier}}</td>
                    </tr>
                {{end}}
                </tbody>
                <tfoot>
                    <tr><td colspan="3" class="summary"><b>Average Tier: {{$l.AvgTier}}</b></td></tr>
                    <tr><td colspan="3" class="summary"><b>Opponent Average Tier: {{$l.AvgOppTier}}</b></td></tr>
                    <tr>
                        <td colspan="3" class="summary">
                            <div class="winprob-row">
                                <span class="winprob-label">Win Probability:</span>
                                <span class="winprob-bar-wrap">
                                    <span class="winprob-bar-bg">
                                        <span class="winprob-bar" style="width: {{parseWinProb $l.WinProb}}%; background: {{winProbColor $l.WinProb}};"></span>
                                    </span>
                                </span>
                                <span class="winprob-badge" style="background: {{winProbColor $l.WinProb}};">
                                    {{parseWinProb $l.WinProb}}%
                                </span>
                                <span class="winprob-emoji">{{parseWinEmoji $l.WinProb}}</span>
                            </div>
                        </td>
                    </tr>
                    <tr><th colspan="3" class="bench-header">Bench</th></tr>
                    {{range $l.Bench}}
                        <tr{{if eq .Tier 1}} class="tier1"{{else if .ShouldSwapIn}} class="swap-candidate"{{end}}><td>{{.Pos}}</td><td>{{if eq .Tier 1}}<span class="tier1-star">★</span> {{end}}{{if .ShouldSwapIn}}<span class="swap-icon">⇄</span> {{end}}{{.Name | safe}}</td><td>{{.Tier}}</td></tr>
                    {{end}}
                    {{range $l.BenchUnranked}}
                        <tr><td>{{.Pos}}</td><td>{{.Name | safe}}</td><td>{{.Tier}}</td></tr>
                    {{end}}
                </tfoot>
            </table>
            <br>
            <div class="fa-section">
                <div class="fa-header">Top 3 ranked Free Agents</div>
                <div class="fa-tabs">
                    <button class="fa-tab" onclick="showFATab(event, 'fa-{{$i}}-QB')" id="defaultFATab{{$i}}">QB</button>
                    <button class="fa-tab" onclick="showFATab(event, 'fa-{{$i}}-RB')">RB</button>
                    <button class="fa-tab" onclick="showFATab(event, 'fa-{{$i}}-WR')">WR</button>
                    <button class="fa-tab" onclick="showFATab(event, 'fa-{{$i}}-TE')">TE</button>
                    <button class="fa-tab" onclick="showFATab(event, 'fa-{{$i}}-DST')">DST</button>
                    <button class="fa-tab" onclick="showFATab(event, 'fa-{{$i}}-K')">K</button>
                </div>
                <div class="fa-tab-contents">
                    <div class="fa-tab-content" id="fa-{{$i}}-QB" style="display:block;">
                        {{with index $l.FreeAgentsByPos "QB"}}
                        <table class="sortable-table pretty-table fa-table">
                            <thead>
                                <tr><th colspan="3" class="fa-pos-header">QB</th></tr>
                                <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                            </thead>
                            <tbody>
                            {{range .}}
                                <tr{{if .IsUpgrade}} class="fa-upgrade fa-upgrade-strong"{{end}}>
                                    <td>{{.Pos}}</td>
                                    <td>{{.Name | safe}}
                                        {{if .IsUpgrade}}
                                            <span class="fa-upgrade-icon fa-upgrade-strong-icon">⬆️</span>
                                            <span class="fa-upgrade-for fa-upgrade-strong-for">
                                                <b style="color:#c62828; font-size:1.08em;">OBVIOUS UPGRADE</b><br>
                                                <span style="color:#c62828; font-weight:bold;">(Upgrade for {{.UpgradeType}}: {{.UpgradeFor}})</span>
                                            </span>
                                        {{end}}
                                    </td>
                                    <td>{{.Tier}}</td>
                                </tr>
                            {{end}}
                            </tbody>
                        </table>
                        {{end}}
                    </div>
                    <div class="fa-tab-content" id="fa-{{$i}}-RB" style="display:none;">
                        {{with index $l.FreeAgentsByPos "RB"}}
                        <table class="sortable-table pretty-table fa-table">
                            <thead>
                                <tr><th colspan="3" class="fa-pos-header">RB</th></tr>
                                <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                            </thead>
                            <tbody>
                            {{range .}}
                                <tr{{if .IsUpgrade}} class="fa-upgrade"{{end}}>
                                    <td>{{.Pos}}</td>
                                    <td>{{.Name | safe}}
                                        {{if .IsUpgrade}}
                                            <span class="fa-upgrade-icon">⬆️</span>
                                            <span class="fa-upgrade-for">
                                                (Upgrade for {{.UpgradeType}}: {{.UpgradeFor}})
                                            </span>
                                        {{end}}
                                    </td>
                                    <td>{{.Tier}}</td>
                                </tr>
                            {{end}}
                            </tbody>
                        </table>
                        {{end}}
                    </div>
                    <div class="fa-tab-content" id="fa-{{$i}}-WR" style="display:none;">
                        {{with index $l.FreeAgentsByPos "WR"}}
                        <table class="sortable-table pretty-table fa-table">
                            <thead>
                                <tr><th colspan="3" class="fa-pos-header">WR</th></tr>
                                <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                            </thead>
                            <tbody>
                            {{range .}}
                                <tr{{if .IsUpgrade}} class="fa-upgrade"{{end}}>
                                    <td>{{.Pos}}</td>
                                    <td>{{.Name | safe}}
                                        {{if .IsUpgrade}}
                                            <span class="fa-upgrade-icon">⬆️</span>
                                            <span class="fa-upgrade-for">
                                                (Upgrade for {{.UpgradeType}}: {{.UpgradeFor}})
                                            </span>
                                        {{end}}
                                    </td>
                                    <td>{{.Tier}}</td>
                                </tr>
                            {{end}}
                            </tbody>
                        </table>
                        {{end}}
                    </div>
                    <div class="fa-tab-content" id="fa-{{$i}}-TE" style="display:none;">
                        {{with index $l.FreeAgentsByPos "TE"}}
                        <table class="sortable-table pretty-table fa-table">
                            <thead>
                                <tr><th colspan="3" class="fa-pos-header">TE</th></tr>
                                <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                            </thead>
                            <tbody>
                            {{range .}}
                                <tr{{if .IsUpgrade}} class="fa-upgrade"{{end}}>
                                    <td>{{.Pos}}</td>
                                    <td>{{.Name | safe}}
                                        {{if .IsUpgrade}}
                                            <span class="fa-upgrade-icon">⬆️</span>
                                            <span class="fa-upgrade-for">
                                                (Upgrade for {{.UpgradeType}}: {{.UpgradeFor}})
                                            </span>
                                        {{end}}
                                    </td>
                                    <td>{{.Tier}}</td>
                                </tr>
                            {{end}}
                            </tbody>
                        </table>
                        {{end}}
                    </div>
                    <div class="fa-tab-content" id="fa-{{$i}}-DST" style="display:none;">
                        {{with index $l.FreeAgentsByPos "DST"}}
                        <table class="sortable-table pretty-table fa-table">
                            <thead>
                                <tr><th colspan="3" class="fa-pos-header">DST</th></tr>
                                <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                            </thead>
                            <tbody>
                            {{range .}}
                                <tr{{if .IsUpgrade}} class="fa-upgrade"{{end}}>
                                    <td>{{.Pos}}</td>
                                    <td>{{.Name | safe}}
                                        {{if .IsUpgrade}}
                                            <span class="fa-upgrade-icon">⬆️</span>
                                            <span class="fa-upgrade-for">
                                                (Upgrade for {{.UpgradeType}}: {{.UpgradeFor}})
                                            </span>
                                        {{end}}
                                    </td>
                                    <td>{{.Tier}}</td>
                                </tr>
                            {{end}}
                            </tbody>
                        </table>
                        {{end}}
                    </div>
                    <div class="fa-tab-content" id="fa-{{$i}}-K" style="display:none;">
                        {{with index $l.FreeAgentsByPos "K"}}
                        <table class="sortable-table pretty-table fa-table">
                            <thead>
                                <tr><th colspan="3" class="fa-pos-header">K</th></tr>
                                <tr><th>Position</th><th>Player</th><th>Tier</th></tr>
                            </thead>
                            <tbody>
                            {{range .}}
                                <tr{{if .IsUpgrade}} class="fa-upgrade"{{end}}>
                                    <td>{{.Pos}}</td>
                                    <td>{{.Name | safe}}
                                        {{if .IsUpgrade}}
                                            <span class="fa-upgrade-icon">⬆️</span>
                                            <span class="fa-upgrade-for">
                                                (Upgrade for {{.UpgradeType}}: {{.UpgradeFor}})
                                            </span>
                                        {{end}}
                                    </td>
                                    <td>{{.Tier}}</td>
                                </tr>
                            {{end}}
                            </tbody>
                        </table>
                        {{end}}
                    </div>
                </div>
            </div>
        </div>
    {{end}}
</div>
</div>
<style>
    .app-header {
        width: 100%;
        background: linear-gradient(90deg, #232c41 0%, #3a6ee8 100%);
        padding: 32px 0 18px 0;
        text-align: center;
        margin-bottom: 18px;
        box-shadow: 0 2px 12px rgba(30,38,54,0.10);
    }
    .app-header h1 {
        color: #eaf0fa;
        font-family: 'Raleway', Arial, sans-serif;
        font-size: 2.3em;
        font-weight: 800;
        letter-spacing: 1px;
        margin: 0;
        text-shadow: 0 2px 8px rgba(30,38,54,0.18);
    }
    .main-content {
        max-width: 900px;
        margin: 0 auto;
        padding: 24px 16px 0 16px;
        background: rgba(35,44,65,0.98);
        border-radius: 10px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.12);
    }
.fa-section { margin-top: 2em; }
.fa-header { font-size: 1.2em; font-weight: bold; margin-bottom: 0.5em; }
.fa-tabs { margin-bottom: 1em; }
.fa-tab { background: #f2f2f2; border: 1px solid #ccc; border-bottom: none; padding: 0.5em 1.2em; cursor: pointer; font-weight: bold; margin-right: 0.2em; border-radius: 6px 6px 0 0; }
.fa-tab.active, .fa-tab:focus { background: #e0eaff; color: #1a237e; border-bottom: 2px solid #1a237e; outline: none; }
.fa-tab-content { padding: 0.5em 0; }
.fa-upgrade { background: #eaffea; }
.fa-upgrade-icon { color: #2e7d32; font-weight: bold; }
.fa-upgrade-for { color: #2e7d32; font-size: 0.95em; margin-left: 0.3em; }
.fa-pos-header { background: #f7f7f7; font-size: 1.1em; }
/* Strong highlight for obvious upgrades on first tab */
.fa-upgrade-strong { background: #ffeaea !important; border: 2px solid #c62828 !important; box-shadow: 0 0 8px #c6282833; }
.fa-upgrade-strong-icon { color: #c62828 !important; font-size: 1.3em; animation: fa-pulse 1s infinite alternate; }
.fa-upgrade-strong-for { color: #c62828 !important; font-size: 1.08em; font-weight: bold; margin-left: 0.3em; }
@keyframes fa-pulse { 0% { transform: scale(1); } 100% { transform: scale(1.15); } }
</style>
<script>
function showLeagueTab(evt, tabId) {
    document.querySelectorAll('.league-content').forEach(div => div.style.display = 'none');
    document.getElementById(tabId).style.display = 'block';
    document.querySelectorAll('.league-tab').forEach(btn => btn.classList.remove('active'));
    evt.currentTarget.classList.add('active');
}
if (document.getElementById('defaultTab')) document.getElementById('defaultTab').click();

function showFATab(evt, tabId) {
    var parent = evt.currentTarget.closest('.fa-section');
    parent.querySelectorAll('.fa-tab-content').forEach(div => div.style.display = 'none');
    parent.querySelectorAll('.fa-tab').forEach(btn => btn.classList.remove('active'));
    document.getElementById(tabId).style.display = 'block';
    evt.currentTarget.classList.add('active');
}
// Auto-select first FA tab for each league
document.querySelectorAll('[id^=defaultFATab]').forEach(function(tab){ tab.click(); });
</script>
<script src="/static/sortable.js"></script>

<footer style="margin-top:2em; text-align:center; font-size:1em; color:#888;">
        <div style="margin-bottom:0.5em;">
            Tiers powered by <a href="https://www.borischen.co/" target="_blank" rel="noopener">Boris Chen</a> |
            <a href="https://github.com/wbollock/sleeperPy" target="_blank" rel="noopener">GitHub Repo</a>
            <span style="margin-left:1em; color:#666;">If you like this project, please <a href="https://github.com/wbollock/sleeperPy" target="_blank" rel="noopener">drop a ⭐ on GitHub</a>!</span>
        </div>
</footer>
{{end}}
